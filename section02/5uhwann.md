# Section2: 웹 서버와 서블릿 컨테이너

## 웹 서버

### 전통적인 방식 vs 최근 방식

과거의 전통적인 방식으로는 웹 애플리케이션을 개발할 때, 우선 서버에 톰캣과 같은 WAS를 설치 후 이 WAS에서 동작하도록 코드를 작성 하고 WAR 형식으로 빌드를 하여 war파일을 만들었다.

이 war파일을 배포하여 웹 애플리케이션을 개발하였다.

이러한 방식은 WAS 기반 위에서 개발, 실행 해야 하고 추가적인 복잡한 설정이 필요했다.

최근의 스프링 부트는 내장 톰켓을 포함하고 있다. WAS가 라이브러리로 내장되어 있기 때문에 개발자는 코드를 작설해 JAR로 빌드 후 원하는 위치에 JAR를 실행하기만 된다.

## JAR, WAR

### JAR(Java Archive)

- 자바가 여러 클래스와 관련 리소스를 압축하여 만든 파일
- JVM 위에서 직접 실행되거나 다른 곳에서 사용하는 라이브러리로 제공

### WAR(Web Application Archive)

- WAS(웹 애플리케이션 서버)배포용 파일
- WAR는 웹 애플리케이션 서버 위에서 실행됨
- HTML과 같은 정적 리소스와 클래스 파일을 모두 함게 포함하고 있음

## 서블릿 컨테이너 초기화

- WAS를 실행하는 시점에 필요한 초기화 작업들이 있다. 서비스에 필요한 필터와 서블릿을 등록하고, 여기에 스프링을 사용한다면 스프링 컨테이너를 만들고, 서블릿과 스프링을 연결하는 디스페처 서블릿도 등록해야 한다.
- WAS가 제공하는 초기화 기능을 사용하면, WAS 실행 시점에 이러한 초기화 과정을 진행할 수 있다.

### 서블릿을 등록하는 2가지 방법

1. `@WebServlet` 어노테이션
2. 프로그래밍 방식

**\*서블릿을 등록할 때 프로그래밍 방식을 사용해야 한다.**

→ 어노테이션 방식을 사용하면 서블릿을 편리하게 등록 가능하지만 유연하게 변경하는 것이 어렵다. ex) `@WebServlet(urlPatterns = "/test")` : `/test`의 경로를 변경하려면 직접 코드를 변경해야 함

### 어플리케이션 초기화(조금 더 유연한 서블릿 컨테이너 초기화)

- 자세한 과정은 강의 확인
- 서블릿 컨테이너 초기화 보다 복잡하지만 애플리케이션 초기화라는 개념이 가지는 장점이 있음
  - `ServletContainerInitializer` 인터페이스를 구현 코드x 및 지정X
  - 특정 인터페이스만 구현하면 됨
  - 서블릿 컨테이너에 상관없이 원하는 모양으로 인터페이스를 만들어 애플리케이션 초기화 코드가 서블릿 컨테이너에 대한 의존을 줄일 수 있음.

## 스프링 컨테이너 등록

### 스프링 컨테이너 등록 과정

1. 스프링 컨테이너 생성
2. 스프링MVC 컨트롤러를 스프링 컨테이너에 빈으로 등록
3. 스프링MVC를 사용하는데 필요한 디스패처 서블릿을 서블릿 컨테이너 등록

### **스프링 MVC 서블릿 컨테이너 초기화 지원**

- 스프링 컨테이너 등록을 하고 서블릿 컨테이너에 등록하기 위해 서블릿 컨테이너를 초기화 하는 과정은 상당히 번거롭고 반복되는 작업이다.
- 스프링 MVC는 이러한 서블릿 컨테이너 초기화 작업을 이미 만들어 두었기 때문에 개발자는 이 과정을 생략하고 애플리케이션 초기화 코드만 작성하면 된다.
- 스프링이 지원하는 애플리케이션 초기화 사용을 위한 인터페이스

  ```java
  public interface WebApplicationInitializer {
      void onStartup(ServletContext servletContext) throws ServletException;
  }
  ```

  `spring-web` 라이브러리를 열어보면 서블릿 컨테이너 초기화를 위한 등록 파일을 확인할 수 있다. 그리고 이곳에 서블릿 컨테이너 초기화 클래스가 등록되어 있다.

      `org.springframework.web.SpringServletContainerInitializer`

  ```java
  @HandlesTypes(WebApplicationInitializer.class)
  public class SpringServletContainerInitializer implements ServletContainerInitializer {}
  ```
